<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!--Import Google Icon Font-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">
    <link rel="stylesheet" href="assets/css/style.css">


</head>

<body>
    <header>
        <div class="navbar-fixed">
            <nav class="nav">
                <div class="nav-wrapper indigo darken-3">
                    <a href="index.html" class="brand-logo center">Insta
                        <span class="blue-text text-lighten-1">Trip</span>
                    </a>
                    <a href="#" data-activates="mobile-demo" class="button-collapse">
                        <i class="material-icons">menu</i>
                    </a>
                    <ul class="right hide-on-med-and-down">
                        <li class="active">
                            <a href="#" class="indigo-text text-lighten-4">City Page</a>
                        </li>
                    </ul>
                    <ul class="side-nav" id="mobile-demo">
                        <li>
                            <a href="#">Sass</a>
                        </li>
                        <li>
                            <a href="#">Components</a>
                        </li>
                        <li>
                            <a href="#">Javascript</a>
                        </li>
                        <li>
                            <a href="#">Mobile</a>
                        </li>
                    </ul>
                </div>
            </nav>
        </div>
    </header>
    <main class="indigo lighten-4">
        <div id="city-container" class="main-container container">
            <div id="inside-container" class="indigo lighten-5">
                <div id="city-main-pic" class="row center">
                    <img class="responsive-img" src="assets/images/LA/LA-main.jpg">
                    <div class="center blue-text text-lighten-1">
                        <span id="city-main-pic-text"></span>
                    </div>
                    <div class="col s12" style="padding: 0px auto;">
                            <p>Enter a city to search</p>
                            <input id="citySearch" value="Phoenix, AZ">
                            <button id="citySubmit" type="button">Submit</button>
                </div>
                <div class="row center">
                    <div class="col s12 m4 l5">
                        <div class="weather center">
                            <div class="card black-text">
                                <p class="center blue-text text-lighten-3" id="current-city">Los Angeles, CA</p>
                                <div class="card-image waves-effect waves-block waves-light">
                                        <input id="citySearch" value="Phoenix, AZ">
                                        <button id="citySubmit" type="button">Submit</button>
                                        <script>
                                            function cityFunction() {
                                                var c = document.getElementById("citySearch").value;
                                                console.log("City entered: " + c);

                                            }
                                        </script>
                                        <p class="right">
                                            <span id="degree-num"></span>
                                            <span id="degree-F"></span>
                                        </p>
                                    </div>
                                    <div id="coordinates" class="col s12" style="margin: auto;">
                                        <input id="lat" value="33">
                                        <input id="lon" value="-111">
                                        <input id="lat2" value="33">
                                        <input id="lon2" value="-111">
                                        <h1 class="left">
                                            <span id="weather-icon"></span>
                                        </h1>
                                    </div>
                                    <div class="col s12 center">
                                        <div class="col s12">
                                            <p>Current Temp:
                                                <span id="high-temp-text" style="font-size: 22px; font-weight: bold;">94</span>
                                                <b>°F</b>
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                <p class="center blue-text text-lighten-3">≈ Wind: mph | Humidity: %</p>
                            </div>
                            <br>
                            <br>
                        </div>
                    </div>
                </div>

                <div class="row center" id="webcam">
                    <div class="webcam col s12 m4 l5">
                        <div class="row">
                                                    </div>
                        <div class="card">
                            <div class="card-image">
                                <img src="https://images.webcams.travel/preview/1170271514.jpg">
                            </div>
                            <div class="card-content">
                                <div class="card-title">Phoenix: Downtown</div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-image">
                                <img src="https://images.webcams.travel/preview/1177589925.jpg">
                            </div>
                            <div class="card-content">
                                <div class="card-title">Phoenix: South Mountain</div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-image">
                                <img src="https://images.webcams.travel/preview/1177589977.jpg">
                            </div>
                            <div class="card-content">
                                <div class="card-title">Phoenix: Estrella Montains</div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-image">
                                <img src="https://images.webcams.travel/preview/1177590023.jpg">
                            </div>
                            <div class="card-content">
                                <div class="card-title">Phoenix: White Tank Mountains</div>
                            </div>
                        </div>
                        
                        </div>
                    </div>
                </div>
                <div class="map">
                    <div class="col s12 m8 l7">
                        <div class="card">
                            <div class="card-image waves-effect waves-block waves-light">
                                <img class="activator responsive-img" src="http://via.placeholder.com/250x250">
                            </div>
                            <div class="card-content">
                                <span class="card-title activator grey-text text-darken-4">Card Title
                                    <i class="material-icons right">more_vert</i>
                                </span>
                                <p>
                                    <a href="#">This is a link</a>
                                </p>
                            </div>
                            <div class="card-reveal">
                                <span class="card-title grey-text text-darken-4">
                                    <i class="material-icons right">close</i>Card Title</span>
                                <p>Here is some more information about this product that is only revealed once clicked on.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="food-pics center">
                    <div class="row">
                        <div class="col s2">
                            <img class="responsive-img" src="http://via.placeholder.com/150x150" alt="">
                        </div>
                        <div class="col s2">
                            <img class="responsive-img" src="http://via.placeholder.com/150x150" alt="">
                        </div>
                        <div class="col s2">
                            <img class="responsive-img" src="http://via.placeholder.com/150x150" alt="">
                        </div>
                        <div class="col s2">
                            <img class="responsive-img" src="http://via.placeholder.com/150x150" alt="">
                        </div>
                        <div class="col s2">
                            <img class="responsive-img" src="http://via.placeholder.com/150x150" alt="">
                        </div>
                        <div class="col s2">
                            <img class="responsive-img" src="http://via.placeholder.com/150x150" alt="">
                        </div>
                    </div>
                </div>
                <div class="col s8">
                    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ab sequi quod et praesentium, aspernatur voluptate
                        quia dolor sit amet, tenetur esse asperiores expedita reiciendis alias, nam nemo iusto? Quos autem
                        aliquid soluta quas minima, similique aut voluptas corrupti quasi tempora facilis, odit iusto sit
                        cum incidunt nulla odio laudantium quam! Lorem ipsum dolor sit amet consectetur adipisicing elit.
                        Voluptatum dolore numquam saepe sed magni quas natus vero assumenda nesciunt. Vero, numquam esse.
                        Cumque excepturi necessitatibus aspernatur at eligendi? Odio, voluptates corporis. Eius quasi, ipsum
                        suscipit facilis fugiat esse mollitia amet voluptatem quae quam, blanditiis, porro modi numquam.
                        Ex, et dolore? Lorem ipsum dolor sit amet, consectetur adipisicing elit. Aperiam, laudantium! Lorem
                        ipsum dolor sit amet.
                    </p>
                </div>
                <div class="col s4">
                    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Fugiat sed, esse eligendi qui eum similique
                        quidem saepe magnam autem ab ducimus quia veniam eos ex optio sapiente. Iste velit, consequatur repellat
                        quisquam dicta repellendus blanditiis eligendi laudantium neque earum explicabo! Ex consequatur ullam,
                        at nihil facilis aspernatur necessitatibus impedit rerum.
                    </p>
                </div>
                <div class="col s6">
                    <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptates error, unde non, iure, nemo accusamus
                        molestias ab harum dolore corrupti et voluptate excepturi velit rerum? Quaerat ullam consequuntur
                        sit, vitae molestias ipsam animi recusandae quidem cum, voluptatibus voluptatem blanditiis magnam
                        praesentium earum itaque ex consectetur aliquam ab rerum esse. Pariatur.
                    </p>
                </div>
                <div class="col s6">
                    <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Eius nihil autem dignissimos odio quisquam laborum,
                        illum itaque nesciunt commodi nisi pariatur eos enim impedit esse sunt voluptatum beatae est tenetur
                        eveniet dolores quaerat! Qui obcaecati quibusdam enim deleniti dolorum incidunt necessitatibus, explicabo
                        distinctio error! Accusantium enim sequi optio tempora eligendi?
                    </p>
                </div>
            </div>
        </div>

    </main>
    <footer class="page-footer indigo darken-3">
        <div class="container">
            <div class="row">
                <div class="col l6 s12">
                    <h5 class="blue-text text-lighten-1">Footer Content</h5>
                    <p class="indigo-text text-lighten-4">You can use rows and columns here to organize your footer content.</p>
                </div>
                <div class="col l4 offset-l2 s12">
                    <h5 class="blue-text text-lighten-1">Created by:</h5>
                    <ul>
                        <li>
                            <a class="indigo-text text-lighten-4" href="#!">Gehrig Rankin</a>
                        </li>
                        <li>
                            <a class="indigo-text text-lighten-4" href="#!">Abe Rivera</a>
                        </li>
                        <li>
                            <a class="indigo-text text-lighten-4" href="#!">Fernando Zacarias</a>
                        </li>
                        <li>
                            <a class="indigo-text text-lighten-4" href="#!">Bob Schneider</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="footer-copyright indigo">
            <div class="container">
                © 2014 Copyright Text
                <a class="grey-text text-lighten-4 right" href="#!">More Links</a>
            </div>
        </div>
    </footer>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script>
        $("#citySubmit").on("click", function () {

            var googleAPIkey = "AIzaSyDjoG9b-qqRgMcdpiNWXHei7WpRu1BmuBk";
            var mapaddress = $("#citySearch").val();
            var endpoint = "https://maps.googleapis.com/maps/api/geocode/json?address=" + mapaddress + "&key=" + googleAPIkey;

            $.ajax({
                url: endpoint,
                type: "GET", // The HTTP Method
                dataType: "json",
                error: function (err) {
                    console.log(err);
                }
            }).done(function (data) {
                lat = data.results[0].geometry.bounds.northeast.lat;
                lon = data.results[0].geometry.bounds.northeast.lng;

                $("#lat").val(lat);
                $("#lon").val(lon);

                lat2 = data.results[0].geometry.bounds.southwest.lat;
                lon2 = data.results[0].geometry.bounds.southwest.lng;


                $("#lat2").val(lat2);
                $("#lon2").val(lon2);

                // lat  and lon perameters 
                console.log(lat + lon + lat2 + lon2);
            });
            // end ajax call 1
        });




        $("#citySubmit").on("click", function () {

            //OpenWeatherMap API
            var weatherAPIKey = "743a4ef3c30935fe19ecbad14f631fae";

            var lat = $("#lat").val();
            var lon = $("#lon").val();
            var weatherQueryURL = "https://api.openweathermap.org/data/2.5/weather?lat=" + lat + "&lon=" + lon + "&APPID=" + weatherAPIKey;
            console.log(weatherQueryURL);

            // Performing our AJAX GET request
            $.ajax({
                url: weatherQueryURL,
                method: "GET"
            })
                // After the data comes back from the API
                .then(function (response) {
                    //Storing an array of results in the results variable
                    var weatherData = response.weather;
                    //A div to hold the weather data
                    var weatherDiv = $("<div class='weather-divs'>");
                    //Set a variable to the temp from the API
                    var placeTemp = response.main.temp;
                    //Convert temp from Kelvin to Fahrenheit
                    var tempF = Math.floor(placeTemp * (9 / 5) - 459.67);
                    //Creating an element to have the temp displayed
                    $("#high-temp-text").text(tempF);
                    var pTemp = $("<p style='font-weight: bold;'>").text("Temp: " + tempF + "F");
                    //Set a variable to the weather description
                    var weatherDesc = response.weather[0].description;
                    //Method for weather desc string to capitalize first letter of each word 
                    weatherDesc = weatherDesc.toLowerCase().replace(/\b[a-z]/g, function (letter) {
                        return letter.toUpperCase();
                    });
                    //Create a paragraph element to display the weather description
                    var pDesc = $("<p>").text(weatherDesc);
                    // Set a variable to the icon code for the current weather
                    var iconCode = response.weather[0].icon;
                    var iconURL = "https://openweathermap.org/img/w/" + iconCode + ".png";
                    console.log(iconURL);
                    var iconHTML = $("<img>");
                    iconHTML.attr("src", iconURL);
                    iconHTML.attr("class", "weather-icon");
                    //Update weather div with the temp and weather icon
                    weatherDiv.append(pTemp, pDesc, iconHTML);
                    //Update page with the weather div content
                    $("#result").append(weatherDiv);
                });


        });





        $("#citySubmit").on("click", function () {

            var lat = $("#lat").val();

            var lon = $("#lon").val();

            var lat2 = $("#lat2").val() + 2;

            var lon2 = $("#lon2").val() + 2;


            var mashapeauthkey = "Eg0ZQFdgZrmshgRuNT3elKYlPu0Mp1yQbzPjsnIocSuKYu0yV5";
            //use lat lon from alt app to populate coordinates

            var endpoint2 =
                "https://webcamstravel.p.mashape.com/webcams/list/bbox=" + lat + "," + lon + "," + lat2 + "," + lon2 + "?show=webcams%3Aimage%2Clocation";
            console.log(endpoint2);


            $.ajax({
                url: endpoint2,
                type: "POST", // The HTTP Method
                data: {},
                dataType: "json",
                error: function (err) {
                    console.log(err);
                },
                beforeSend: function (xhr) {
                    xhr.setRequestHeader("X-Mashape-Authorization", mashapeauthkey);
                }
            }).done(function (data2) {

                console.log(data2);
                for (var i = 0; i < data2.result.webcams.length; i++) {
                    // create a "card" variable, it's going to be a div
                    var card = $("<div>");
                    card.addClass("card");
                    var imagediv = $("<div>");
                    imagediv.addClass("card-image");
                    var img = $("<img>");
                    img.attr("src", data2.result.webcams[i].image.current.preview);
                    imagediv.html(img);
                    card.html(imagediv);
                    var cardcontent = $("<div>");
                    cardcontent.addClass("card-content");
                    var cardtitle = $("<div>");
                    cardtitle.addClass("card-title");
                    cardtitle.text(data2.result.webcams[i].title);
                    cardcontent.html(cardtitle);
                    card.append(cardcontent);
                    $(".webcam").append(card);
                }
            });
            // end ajax call 2
        });
    </script>
</body>

</html>